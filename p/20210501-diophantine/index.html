<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>从不定方程的非负整数解个数谈起 - sun123zxy's Blog</title>

        <script src="/assets/thirds/jquery/jquery-3.5.1.min.js"></script>

        <link rel="stylesheet" href="/assets/thirds/katex/katex.min.css">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="/assets/thirds/katex/katex.min.js"></script>
        <!-- To automatically render math in text elements, include the auto-render extension -->
        <script defer src="/assets/thirds/katex/auto-render.min.js" onload="renderMathInElement(document.body)"></script>
        
        <script src="/assets/thirds/highlight/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
    </head>
    <body>
        <div id="home">
    <div id="main" class="panel panel-content">
        <div class="post-body">
    <div class="post-head">
        <h1 id="post-title">从不定方程的非负整数解个数谈起</h1>
        <p class="abstract text-vice">
            
                组合意义、范德蒙德卷积、杨辉三角、生成函数、广义二项式定理、Burnside(Polya) 以及第一类斯特林数，你从未见过的全新解法。
            
        </p>
    </div>
    <div class="post-content"><h2 id="序">序</h2>
<blockquote>
<p>求将 <span class="math inline">\(n\)</span> 个无标号元素用 <span
class="math inline">\(m-1\)</span> 个隔板分入 <span
class="math inline">\(m\)</span> 个有标号可空集合的方案数。</p>
</blockquote>
<p>或</p>
<blockquote>
<p>求不定方程</p>
<p><span class="math display">\[
x_1 + x_2 + \dots + x_m = n \quad (m,n \in N_+, m \le n)
\]</span></p>
<p>的非负整数解的个数。</p>
</blockquote>
<p>是一个非常经典的组合问题，众所周知其答案为组合数 <span
class="math inline">\({n+m-1 \choose m-1}\)</span>
，这可以根据其组合意义结合隔板法容易的得到。</p>
<p>然而，笔者发现还有很多有趣的方法可以得到上式，值得探讨一番。</p>
<h2 id="组合意义">组合意义</h2>
<p>如上所述，组合意义可以结合隔板法容易的得到。考虑将 <span
class="math inline">\(n\)</span> 个无标号元素用 <span
class="math inline">\(m-1\)</span> 个隔板分入 <span
class="math inline">\(m\)</span> 个有标号非空集合，其方案数为 <span
class="math inline">\({n-1 \choose m-1}\)</span>
。然而我们需要的是各集合可空情况下的方案数。考虑新增 <span
class="math inline">\(m\)</span>
个元素，先给每个集合放一个元素垫底，再做各组可空的分配。这个小Trick让我们将问题转化为求
<span class="math inline">\(n+m\)</span> 个无标号元素分入 <span
class="math inline">\(m\)</span>
个非空有标号集合的方案数。再用隔板法，得到答案 <span
class="math inline">\({n+m-1 \choose m-1}\)</span> 。</p>
<p>形式化的，我们令 <span class="math inline">\(y_i = x_i + 1\)</span>
，则我们现在只需求 <span class="math inline">\(y_1 + y_2 + \dots + y_m =
n + m\)</span> 的正整数解，隔板法得到答案 <span
class="math inline">\({n+m-1 \choose m-1}\)</span> 。</p>
<h2 id="枚举空位范德蒙德卷积公式">枚举空位——范德蒙德卷积公式</h2>
<p>我们使用另一种方法将隔板法应用到可空集合上。</p>
<p>枚举 <span class="math inline">\(m\)</span>
个集合中有几个是空集，可以得到下式</p>
<p><span class="math display">\[
\mathrm{ans} = \sum_{k=0}^{m-1} {m \choose k} {n-1 \choose m-k-1}
\]</span></p>
<p>又由范德蒙德卷积公式</p>
<blockquote>
<p><span class="math display">\[
{n+m \choose k} = \sum_{i=\max(0,k-m)}^{\min(n,k)} {n \choose i} {m
\choose k-i}
\]</span></p>
<p>（范德蒙德卷积公式易由 <span class="math inline">\((1+x)^{n+m} =
(1+x)^n (1+ x)^m\)</span> 的二项式展开说明）</p>
</blockquote>
<p>可直接得到（ <span class="math inline">\(k&#39; = m-1\)</span> ，
<span class="math inline">\(n&#39; = m\)</span> ， <span
class="math inline">\(m&#39; = n-1\)</span> ）</p>
<p><span class="math display">\[
\mathrm{ans} = \sum_{k=\max(0,(m-1)-(n-1))}^{\min(m,m-1)} {m \choose k}
{n-1 \choose m-k-1} = {n+m-1 \choose m-1}
\]</span></p>
<h2 id="递推杨辉三角">递推——杨辉三角</h2>
<p>这固然很妙，但要是我想不到这些Trick怎么办？</p>
<p>不会通项就设状态dp呗（<del>反正是OIer有电脑帮我算</del></p>
<p>设状态 <span class="math inline">\(f(n,m)\)</span> 表示将 <span
class="math inline">\(n\)</span> 个无标号元素放入 <span
class="math inline">\(m\)</span> 个有标号可空集合的方案数。</p>
<p>考虑当前正在为第 <span class="math inline">\(n\)</span>
个元素确定所属集合。既然元素是无标号的，不妨按升序排列集合。于是放入新的元素时，只需决定要先跳过多少个集合再放入。易得下面的递推式</p>
<p><span class="math display">\[
f(n,m) = \sum_{k=1}^m f(n-1,k)
\]</span></p>
<p>初始状态满足</p>
<p><span class="math display">\[
\begin{aligned}
&amp;f(0,m)=1 \\
&amp;f(n,0)=[n=0]
\end{aligned}
\quad (n,m \in N)
\]</span></p>
<p>（中括号是艾弗森括号）</p>
<p>不妨列出 <span class="math inline">\(f\)</span> 的前几项——</p>
<pre><code>    m0   m1   m2   m3   m4
n0  1    1    1    1    1
n1  0    1    2    3    4
n2  0    1    3    6    10
n3  0    1    4    10   20</code></pre>
<p>很熟悉...这是杨辉三角！</p>
<p>可以由递推式得到杨辉三角的特征——</p>
<p><span class="math display">\[
\begin{aligned}
f(n,m) &amp;= f(n-1, m) + \sum_{k=1}^{m-1} f(n-1,k) \\
&amp;= f(n-1, m) + f(n, m-1)
\end{aligned}
\]</span></p>
<p>那么，只需观察并将表格的每一项映射到杨辉三角，我们就能得到 <span
class="math inline">\(f(n,m) = {n+m+1 \choose m-1}\)</span> 。</p>
<h2 id="生成函数广义二项式定理">生成函数——广义二项式定理</h2>
<p><del>要是我连杨辉三角都没看出来怎么办</del></p>
<p>方便起见，此处我们不研究 <span class="math inline">\(m=0\)</span>
的情况。不妨设</p>
<p><span class="math display">\[
g(n,m) = f(n,m+1)
\]</span></p>
<p>显然， <span class="math inline">\(g\)</span> 的递推式为</p>
<p><span class="math display">\[
g(n,m) = \sum_{k=0}^m g(n-1,k)
\]</span></p>
<p>据此我们发现，每一排是其前一排的前缀和数组，或者换句话说，每一排是其后一排的向前差分数组。我们先拿出
<span class="math inline">\(n=0\)</span> 一排的OGF</p>
<p><span class="math display">\[
g_0(x) = \frac{1}{1-x}
\]</span></p>
<p>又根据差分</p>
<p><span class="math display">\[
g_n(x) = g_{n+1}(x) - x g_{n+1}(x) \iff g_{n+1}(x) = \frac{1}{1-x}
g_n(x)
\]</span></p>
<p>得</p>
<p><span class="math display">\[
g_n(x) = (1-x)^{-(n+1)}
\]</span></p>
<p>又由广义二项式定理</p>
<blockquote>
<p><span class="math display">\[
(x+y)^\alpha = \sum_{k=0}^{\infty} {\alpha \choose k} x^k y^{\alpha - k}
\]</span></p>
<p>其中</p>
<p><span class="math display">\[
{\alpha \choose k} = \frac{\alpha(\alpha-1)\dots(\alpha-k+1)}{k!}
\]</span></p>
</blockquote>
<p>展开，得到</p>
<p><span class="math display">\[
g_n(x) = \sum_{k=0}^{\infty} {-n-1 \choose k} (-x)^k
\]</span></p>
<p>故</p>
<p><span class="math display">\[
\begin{aligned}
g_n(x)[x^k] &amp;= (-1)^k {-n-1 \choose k} \\
&amp;= (-1)^k \frac{(-n-1)(-n-2)\dots(-n-k)}{k!} \\
&amp;= \frac{(n+1)(n+2)\dots(n+k)}{k!} \\
&amp;= {n+k \choose k}
\end{aligned}
\]</span></p>
<p>即</p>
<p><span class="math display">\[
g(n,k) = {n+k \choose k}
\]</span></p>
<p>换回 <span class="math inline">\(f\)</span> 表示就得到答案</p>
<p><span class="math display">\[
f(n,m) = g(n,m-1) = {n+m-1 \choose m-1}
\]</span></p>
<h2
id="burnsidepolya第一类斯特林数">Burnside(Polya)——第一类斯特林数</h2>
<p>如果要分组的 <span class="math inline">\(n\)</span>
个元素是有标号的，问题将会简单很多——直接枚举每个元素的所属集合即可，显然方案数为
<span class="math inline">\(m^n\)</span> 。</p>
<p>但关键是它们没有标号。</p>
<p>无标号的本质是认为任意置换标号前后是同构的。这启发我们将所有 <span
class="math inline">\(n\)</span>
元置换（即置换群）作为变换集，使用等价类计数Burnside来解决该问题。</p>
<p>根据Burnside引理（或Polya定理）</p>
<blockquote>
<p><span class="math display">\[
\mathrm{ans} = \frac{1}{|G|} \sum_{f \in G} C(f)
\]</span></p>
<p>其中 <span class="math inline">\(G\)</span> 是变换集， <span
class="math inline">\(C(f)\)</span> 是变换 <span
class="math inline">\(f\)</span> 的不动点。</p>
</blockquote>
<p>可以写出</p>
<p><span class="math display">\[
\mathrm{ans} = \frac{1}{n!} \sum_{p \in \mathrm{perm}(n)}
m^{\mathrm{cyc}(p)}
\]</span></p>
<p>其中 <span class="math inline">\(\mathrm{perm}(n)\)</span> 表示所有
<span class="math inline">\(n\)</span> 元置换的集合，而 <span
class="math inline">\(\mathrm{cyc}(p)\)</span> 指置换 <span
class="math inline">\(p\)</span> 的形成的置换图中环的个数。</p>
<p>在外层枚举 <span class="math inline">\(\mathrm{cyc}(p)\)</span>
，得</p>
<p><span class="math display">\[
\mathrm{ans} = \frac{1}{n!} \sum_{k=1}^n m^k \sum_{p \in
\mathrm{perm}(n)} [\mathrm{cyc}(p) = k]
\]</span></p>
<p><span class="math inline">\(\sum_{p \in \mathrm{perm}(n)}
[\mathrm{cyc}(p) = k]\)</span> 是什么？</p>
<blockquote>
<p>第一类斯特林数 <span class="math inline">\({n \brack k}\)</span>
表示将 <span class="math inline">\(n\)</span> 个有标号元素分成 <span
class="math inline">\(k\)</span> 个无标号圆排列的方案数。</p>
</blockquote>
<p>在置换图中， <span class="math inline">\(p_i\)</span> 表示节点 <span
class="math inline">\(i\)</span> 的下一个节点是 <span
class="math inline">\(p_i\)</span>
。而枚举置换的过程，正是枚举置换图的过程，也正是枚举圆排列的过程！而
<span class="math inline">\([\mathrm{cyc}(p) = k]\)</span>
则为我们确定了环，或者说圆排列的个数。</p>
<p>惊讶的，我们发现</p>
<p><span class="math display">\[
{n \brack k} = \sum_{p \in \mathrm{perm}(n)} [\mathrm{cyc}(p) = k]
\]</span></p>
<p>带入其中，答案式变为</p>
<p><span class="math display">\[
\mathrm{ans} = \frac{1}{n!} \sum_{k=1}^n {n \brack k} m^k
\]</span></p>
<p>于是，根据第一类斯特林数性质之一</p>
<blockquote>
<p><span class="math display">\[
\sum_{k=1}^n {n \brack k} m^k  = m(m+1)\dots(n+m-1)
\]</span></p>
<p>（该性质可以结合第一类斯特林数的递推式做数学归纳得出）</p>
</blockquote>
<p>我们愉快的得到了答案</p>
<p><span class="math display">\[
\mathrm{ans} = \frac{m(m+1)\dots(n+m-1)}{n!} = {n+m-1 \choose m-1}
\]</span></p>
<p>用Burnside解决无标号问题的思路极具启发性，例如<a
href="https://loj.ac/p/6538">烷基计数</a>问题的Burnside解法。</p>
<h2 id="后记致谢">后记&amp;致谢</h2>
<p><del>同分异构体计数带我重回OI</del></p>
<p>感谢TbYangZ菊苣全程提供技术支持。</p>
<p>感谢神仙化学老师提供组合意义解释。</p>
</div>
    <div class="post-tags text-vice" style="text-align: right">
        <p>tags: 
            
                <a href= "/tags#OI" >OI</a>, 
            
                <a href= "/tags#数学" >数学</a>, 
            
                <a href= "/tags#意识流" >意识流</a>
            
        </p>
        <p>posted on 2021/05/01 | last modified on 2021/05/01</p>
    </div>
    
        <div class="post-comments">
            <script src="https://giscus.app/client.js"
                data-repo="sun123zxy/sun123zxy.github.io"
                data-repo-id="MDEwOlJlcG9zaXRvcnkzMTAwMzQxNDc="
                data-category="General"
                data-category-id="DIC_kwDOEnq-484CQKFr"
                data-mapping="pathname"
                data-reactions-enabled="1"
                data-emit-metadata="0"
                data-input-position="bottom"
                data-theme="light"
                data-lang="en"
                crossorigin="anonymous">
            </script>
        </div>
    
</div>
    </div>
    <div id="sidebar">
        
            <div id="sidebar-profile" class="panel">
                
                <div class="panel-content">
                    <a href="/"><img class="avatar" src="/assets/images/pig.png"></img></a>
<p class="nickname">sun123zxy</p>
<div class="nav">
    <a href="/">Home</a> | 
    <a href="/p/aboutme">About</a> | 
    <a href="/tags">Tags</a>
</div>
<div class="feed">
    <img src="/assets/images/feed.png"></img>
    <a href="/feed.xml">Atom Feed</a>
</div>
<p>Next Phantasm...</p>
                </div>
            </div>
        
            <div id="sidebar-news" class="panel">
                
                <h2 class="panel-title">News</h2>
                
                <div class="panel-content">
                    <a href="https://info.flagcounter.com/1Zpv"><img src="https://s05.flagcounter.com/count2/1Zpv/bg_DDDDDD/txt_000000/border_CCCCCC/columns_2/maxflags_10/viewers_3/labels_0/pageviews_1/flags_0/percent_0/" alt="Flag Counter" border="0"></a>

<p>博客已迁移。访问 <a href="https://blog.sun123zxy.top">blog.sun123zxy.top</a> 获取更多信息。</p>
                </div>
            </div>
        
            <div id="sidebar-links" class="panel">
                
                <h2 class="panel-title">Links</h2>
                
                <div class="panel-content">
                    
<h3>My Friends</h3>
<ul>
    <li><a href="https://www.cnblogs.com/Railgunforever">吸取教训</a></li>
    <li><a href="https://p9t6g.github.io">p9t6g</a></li>
    <li><a href="https://tbyangz.github.io">TbYangZ</a></li>
    <li><a href="https://www.cnblogs.com/ALANALLEN21LOVE28">CJ SYH</a></li>
</ul>

<h3>Related Sites</h3>
<ul>
    <li><a href="http://www.cnblogs.com/sun123zxy">博客园</a></li>
    <li><a href="http://tools.sun123zxy.top">工具站</a></li>
</ul>
                </div>
            </div>
        
            <div id="sidebar-tags" class="panel">
                
                <h2 class="panel-title">Tags</h2>
                
                <div class="panel-content">
                    <ul>
    
    <li><a href= "/tags#OI" >OI</a></li>
    
    <li><a href= "/tags#数学" >数学</a></li>
    
    <li><a href= "/tags#高考" >高考</a></li>
    
    <li><a href= "/tags#题解" >题解</a></li>
    
    <li><a href= "/tags#原创题目" >原创题目</a></li>
    
    <li><a href= "/tags#学习笔记" >学习笔记</a></li>
    
    <li><a href= "/tags#意识流" >意识流</a></li>
    
    <li><a href= "/tags#游记" >游记</a></li>
    
    <li><a href= "/tags#Web" >Web</a></li>
    
    <li><a href= "/tags#站点相关" >站点相关</a></li>
    
    <li><a href= "/tags#Python" >Python</a></li>
    
</ul>
                </div>
            </div>
        
        
            <div id="contents" class="panel"><h2 class="panel-title">Contents</h2>
<div class="panel-content"></div>
<script defer src="/assets/js/contents.js"></script></div>
        
    </div>
    <div class="fclean"></div>
    <div id="footer" class="text-vice">
        <p>sun123zxy's Blog | Powered by Jekyll</p>
    </div>
</div>
<div id="leftdown-float-container">
    <div id="theme-info" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/info.png"></img></div>
        <div class="hover-info">Theme Info</div>
    </div>
    <div id="theme-switch" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/switch.png"></img></div>
        <div class="hover-info">Theme Switch</div>
    </div>
</div>
<div id="rightdown-float-container">
    <div id="music-player" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/music.png"></img></div>
        <div class="hover-info">Music Player</div>
    </div>
</div>
<link rel="stylesheet" href="/assets/css/default.css">
<link rel="stylesheet" id="night-container">
<link rel="stylesheet" id="theme-container">
<div id="mask"></div>
<script src="/assets/js/theme_data.js"></script>
<script src="/assets/js/round_button.js"></script>
<script src="/assets/js/theme_manager.js" defer></script>
<script src="/assets/js/music_player.js"></script>
<script src="/assets/js/scroll.js"></script>
    </body>
</html>