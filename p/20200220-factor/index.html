<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>约数个数函数的一个性质证明，以及其推广 - sun123zxy's Blog</title>

        <script src="/assets/thirds/jquery/jquery-3.5.1.min.js"></script>

        <link rel="stylesheet" href="/assets/thirds/katex/katex.min.css">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="/assets/thirds/katex/katex.min.js"></script>
        <!-- To automatically render math in text elements, include the auto-render extension -->
        <script defer src="/assets/thirds/katex/auto-render.min.js" onload="renderMathInElement(document.body)"></script>
        
        <script src="/assets/thirds/highlight/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
    </head>
    <body>
        <div id="home">
    <div id="main" class="panel panel-content">
        <div class="post-body">
    <div class="post-head">
        <h1 id="post-title">约数个数函数的一个性质证明，以及其推广</h1>
        <p class="abstract text-vice">
            
                关于 \(d(AB) = \sum_{x|A} \sum_{y|B} [\gcd (x,y) = 1]\) 的一系列推导。
            
        </p>
    </div>
    <div class="post-content"><p><a href="https://www.luogu.com.cn/problem/P3327">洛谷P3327
[SDOI2015]约数个数和</a></p>
<p><a href="https://www.luogu.com.cn/problem/P4619">洛谷P4619
[SDOI2018]旧试题</a></p>
<p>要用到这个性质，而且网上几乎没有能看的证明，所以特别提出来整理一下。</p>
<h2 id="original">Original</h2>
<h3 id="二维">二维</h3>
<blockquote>
<p><span class="math display">\[
d(AB) = \sum_{x|A} \sum_{y|B} [\gcd (x,y) = 1]
\]</span></p>
<p>其中 <span class="math inline">\(d\)</span> 是约数个数函数，即 <span
class="math inline">\(d_k (n) = \sum_{d|n} 1\)</span></p>
</blockquote>
<p>（看上去比较不可思议对吧）</p>
<p>右侧的枚举，一部分因子算多了（比如当 <span
class="math inline">\(\gcd(x,y)=1\)</span> 且额外有 <span
class="math inline">\(x|B,y|A\)</span> 时，可以枚举出 <span
class="math inline">\(x*y = y*x\)</span> ），一部分因子又没有算（比如当
<span class="math inline">\(\gcd(A,B) \not= 1\)</span> 时的 <span
class="math inline">\(A*B\)</span>
）。但是算多和算少之间达成了诡异的平衡。</p>
<p>首先考虑 <span class="math inline">\(A,B\)</span>
互质的情况。显然此时右式中的 <span class="math inline">\([\gcd (x,y) =
1]\)</span> 恒成立。而左式可以通过积性函数的性质拆开。两侧都为 <span
class="math inline">\(d(A)*d(B)\)</span>
，成立。（其实并没有按是否互质讨论的必要，但是这样想能让我们的思路更加清晰）</p>
<p>那么考虑 <span class="math inline">\(\gcd(A,B) \not= 1\)</span>
时的情况。不妨先证明 <span class="math inline">\(A = p^a, B =
p^b\)</span> （ <span class="math inline">\(p\)</span> 是素数，这两个
<span class="math inline">\(p\)</span> 是同一个数）时等式成立。</p>
<p>这部分的证明是容易的。根据约数个数的定义，左式显然为 <span
class="math inline">\(a+b+1\)</span>。对于右式，设 <span
class="math inline">\(x = p^c, y= p^d\)</span> ，若要使 <span
class="math inline">\([\gcd (x,y) = 1]\)</span> 成立， <span
class="math inline">\(c,d\)</span> 中至少有一个为 <span
class="math inline">\(0\)</span> 。那么当 <span
class="math inline">\(b=0\)</span>时，<span class="math inline">\(c \in
[0, a]\)</span>；当 <span class="math inline">\(a=0\)</span> 时， <span
class="math inline">\(c \in [0,b]\)</span>
；其他情况都不满足条件。排除重复的 <span class="math inline">\(c=0,
d=0\)</span> ，共有 <span class="math inline">\(a+b+1\)</span>
个情况成立，与左式相同，故等式成立。</p>
<p>讨论更加一般的情况。有了前面的证明，我们考虑将 <span
class="math inline">\(AB\)</span>
分解质因数后食用，分解后的每一项的形式为 <span
class="math inline">\(p^{a+b}\)</span>
。左边根据约数个数基本性质“指数加一连乘积”，即每一个 <span
class="math inline">\(p\)</span> 对应的 <span
class="math inline">\((a+b+1)\)</span> 之积。对于右侧，前证说明对于每个
<span class="math inline">\(p\)</span> ，合法的 <span
class="math inline">\(c,d\)</span> 的选择有对应的 <span
class="math inline">\(a+b+1\)</span> 种，要让 <span
class="math inline">\([\gcd(x,y)=1]\)</span> 需要每一个 <span
class="math inline">\(p\)</span> 都是合法情况。而每个 <span
class="math inline">\(p\)</span>
相对独立，其本质就是许多个“选择”，直接用乘法原理合并起来即可，于是也与左式相同。</p>
<p>用通俗一点的说法，我不管其他的 <span class="math inline">\(p\)</span>
到底需要让 <span class="math inline">\(x,y\)</span>
满足什么样的条件才能使 <span
class="math inline">\([\gcd(x,y)=1]\)</span> ，反正在我这个 <span
class="math inline">\(p\)</span> 这里只有 <span
class="math inline">\(a+b+1\)</span> 个方案有合法的可能性。</p>
<p>总之这样就证毕了。</p>
<p>证明思路很像积性函数的合并，也许对其他一些积性函数命题的证明这种方法也管用。</p>
<p>参考：</p>
<p><a
href="https://www.luogu.com.cn/blog/_post/89727">https://www.luogu.com.cn/blog/_post/89727</a></p>
<p><a
href="https://www.luogu.com.cn/blog/_post/39908">https://www.luogu.com.cn/blog/_post/39908</a></p>
<h3 id="高维">高维</h3>
<p>对于形如 <span class="math display">\[
d(ABC) = \sum_{x|A} \sum_{y|B} \sum_{z|C} [\gcd (x,y) = 1] [\gcd (y,z) =
1] [\gcd (x,z) =1]
\]</span></p>
<p>的高维拓展，证明思路基本相同，不再赘述。（如果觉得有点迷可以先跳过，Extended里的证明更加接近本质）</p>
<h2 id="extended-update-20200308">Extended (update 2020/03/08)</h2>
<p>下面研究 Original 推广到广义约数个数函数的形式。</p>
<h3 id="二维-1">二维</h3>
<blockquote>
<p><span class="math display">\[
\sigma_k (AB) = \sum_{x|A} \sum_{y|B} [\gcd(x,y)=1] (x \frac{B}{y})^k =
\sum_{x|A} \sum_{y|B} [\gcd(x,\frac{B}{y})=1] (x y)^k
\]</span></p>
<p>其中 <span class="math inline">\(\sigma_k\)</span>
是广义的约数个数函数，即 <span class="math inline">\(\sigma_k (n) =
\sum_{d|n} d^k\)</span></p>
</blockquote>
<p>显然中式和右式是等价的。现证明左式和右式等价。</p>
<p>证明思路与上面基本一致。同样的，我们先解决 <span
class="math inline">\(A=p^a, B=p^b\)</span> 的情况。</p>
<p>首先，直接由定义得出左式： <span class="math display">\[
左式 = \sum_{i=0}^{a+b} p^{ik}
\]</span></p>
<p>同样设 <span class="math inline">\(x=p^c, y=p^d\)</span> 。分析 <span
class="math inline">\([\gcd(x,\frac{B}{y})=1]\)</span>
的意义，它的意思是若 <span class="math inline">\(x\)</span> 中不含 <span
class="math inline">\(p\)</span> （ <span
class="math inline">\(c=0\)</span> ），则 <span
class="math inline">\(y\)</span> 可以随便选（ <span
class="math inline">\(d \in [0,b]\)</span> ）；若 <span
class="math inline">\(x\)</span> 中含 <span
class="math inline">\(p\)</span> （ <span class="math inline">\(c \in
[1,a]\)</span> ），则 <span class="math inline">\(y\)</span>
就必须包含所有的 <span class="math inline">\(p\)</span> （ <span
class="math inline">\(d=b\)</span> ），否则 <span
class="math inline">\(\frac{B}{y}\)</span> 里就含有 <span
class="math inline">\(p\)</span> 了；其他情况不满足条件 。</p>
<p>即合法的情况为 <span class="math inline">\((0,[0,b])\)</span> 和
<span class="math inline">\(([1,a],b)\)</span> 。</p>
<p>那么，根据右式的形式，可以得出 <span class="math display">\[
\begin{aligned}
右式 &amp;= \sum_{i=0}^b p^0 p^i + \sum_{i=1}^a p^i p^b \\
&amp;= \sum_{i=0}^b p^i + \sum_{i=1}^a p^{b+i}
\end{aligned}
\]</span></p>
<p>该式实际上只是将左式的枚举从 <span class="math inline">\(b\)</span>
那里切开了。两式是等价的。</p>
<p>那么和上面一样的，对于一般的情况分解质因数，对每一个 <span
class="math inline">\(p\)</span>
分别考虑，积性合并即可。全部乘起来的依据也是乘法原理（ <span
class="math inline">\(\sum * \sum\)</span>
就是在枚举所有的方案对应贡献乘积之和）。可能有人问：这里的 <span
class="math inline">\(B\)</span> 不是发生变化了吗？其实 <span
class="math inline">\(B\)</span> 充当的是一个 <span
class="math inline">\(y\)</span> 的全集，不是 <span
class="math inline">\(p^b\)</span> 了也不影响 <span
class="math inline">\(x,y\)</span>
的取值，所以是没有关系的。可以参考一下 Original 里“通俗一点的说法”。</p>
<h3 id="高维-1">高维</h3>
<p>形如 <span class="math display">\[
\sigma_k (ABC) = \sum_{x|A} \sum_{y|B} \sum_{z|C}
[\gcd(x,\frac{B}{y})=1] [\gcd(y,\frac{C}{z})=1] [\gcd(x, \frac{C}{z}=1)]
(x y z)^k
\]</span></p>
<p>的高维拓展， <span class="math inline">\(\gcd\)</span> 部分就是如
<span class="math inline">\(x-y\)</span> ， <span
class="math inline">\(x-z\)</span> ， <span
class="math inline">\(y-z\)</span>
两两配对的形式，这样来限制取值范围。</p>
<p>证明思路基本相同，同样写出合法情况 <span
class="math inline">\((0,0,[0,c])\)</span> ， <span
class="math inline">\((0,[1,b],c)\)</span> ， <span
class="math inline">\(([1,a],b,c)\)</span> ，对应 <span
class="math inline">\(p^{a+b+c+1}\)</span> ，就容易证明了。</p>
<p>没看到过要用这个的题，已对拍检验正确性。</p>
</div>
    <div class="post-tags text-vice" style="text-align: right">
        <p>tags: 
            
                <a href= "/tags#OI" >OI</a>, 
            
                <a href= "/tags#数学" >数学</a>, 
            
                <a href= "/tags#学习笔记" >学习笔记</a>
            
        </p>
        <p>posted on 2020/02/20 | last modified on 2020/03/08</p>
    </div>
    
        <div class="post-comments">
            <script src="https://giscus.app/client.js"
                data-repo="sun123zxy/sun123zxy.github.io"
                data-repo-id="MDEwOlJlcG9zaXRvcnkzMTAwMzQxNDc="
                data-category="General"
                data-category-id="DIC_kwDOEnq-484CQKFr"
                data-mapping="pathname"
                data-reactions-enabled="1"
                data-emit-metadata="0"
                data-input-position="bottom"
                data-theme="light"
                data-lang="en"
                crossorigin="anonymous">
            </script>
        </div>
    
</div>
    </div>
    <div id="sidebar">
        
            <div id="sidebar-profile" class="panel">
                
                <div class="panel-content">
                    <a href="/"><img class="avatar" src="/assets/images/pig.png"></img></a>
<p class="nickname">sun123zxy</p>
<div class="nav">
    <a href="/">Home</a> | 
    <a href="/p/aboutme">About</a> | 
    <a href="/tags">Tags</a>
</div>
<div class="feed">
    <img src="/assets/images/feed.png"></img>
    <a href="/feed.xml">Atom Feed</a>
</div>
<p>Next Phantasm...</p>
                </div>
            </div>
        
            <div id="sidebar-news" class="panel">
                
                <h2 class="panel-title">News</h2>
                
                <div class="panel-content">
                    <a href="https://info.flagcounter.com/1Zpv"><img src="https://s05.flagcounter.com/count2/1Zpv/bg_DDDDDD/txt_000000/border_CCCCCC/columns_2/maxflags_10/viewers_3/labels_0/pageviews_1/flags_0/percent_0/" alt="Flag Counter" border="0"></a>

<p>博客已迁移。访问 <a href="https://blog.sun123zxy.top">blog.sun123zxy.top</a> 获取更多信息。</p>
                </div>
            </div>
        
            <div id="sidebar-links" class="panel">
                
                <h2 class="panel-title">Links</h2>
                
                <div class="panel-content">
                    
<h3>My Friends</h3>
<ul>
    <li><a href="https://www.cnblogs.com/Railgunforever">吸取教训</a></li>
    <li><a href="https://p9t6g.github.io">p9t6g</a></li>
    <li><a href="https://tbyangz.github.io">TbYangZ</a></li>
    <li><a href="https://www.cnblogs.com/ALANALLEN21LOVE28">CJ SYH</a></li>
</ul>

<h3>Related Sites</h3>
<ul>
    <li><a href="http://www.cnblogs.com/sun123zxy">博客园</a></li>
    <li><a href="http://tools.sun123zxy.top">工具站</a></li>
</ul>
                </div>
            </div>
        
            <div id="sidebar-tags" class="panel">
                
                <h2 class="panel-title">Tags</h2>
                
                <div class="panel-content">
                    <ul>
    
    <li><a href= "/tags#OI" >OI</a></li>
    
    <li><a href= "/tags#数学" >数学</a></li>
    
    <li><a href= "/tags#高考" >高考</a></li>
    
    <li><a href= "/tags#题解" >题解</a></li>
    
    <li><a href= "/tags#原创题目" >原创题目</a></li>
    
    <li><a href= "/tags#学习笔记" >学习笔记</a></li>
    
    <li><a href= "/tags#意识流" >意识流</a></li>
    
    <li><a href= "/tags#游记" >游记</a></li>
    
    <li><a href= "/tags#Web" >Web</a></li>
    
    <li><a href= "/tags#站点相关" >站点相关</a></li>
    
    <li><a href= "/tags#Python" >Python</a></li>
    
</ul>
                </div>
            </div>
        
        
            <div id="contents" class="panel"><h2 class="panel-title">Contents</h2>
<div class="panel-content"></div>
<script defer src="/assets/js/contents.js"></script></div>
        
    </div>
    <div class="fclean"></div>
    <div id="footer" class="text-vice">
        <p>sun123zxy's Blog | Powered by Jekyll</p>
    </div>
</div>
<div id="leftdown-float-container">
    <div id="theme-info" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/info.png"></img></div>
        <div class="hover-info">Theme Info</div>
    </div>
    <div id="theme-switch" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/switch.png"></img></div>
        <div class="hover-info">Theme Switch</div>
    </div>
</div>
<div id="rightdown-float-container">
    <div id="music-player" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/music.png"></img></div>
        <div class="hover-info">Music Player</div>
    </div>
</div>
<link rel="stylesheet" href="/assets/css/default.css">
<link rel="stylesheet" id="night-container">
<link rel="stylesheet" id="theme-container">
<div id="mask"></div>
<script src="/assets/js/theme_data.js"></script>
<script src="/assets/js/round_button.js"></script>
<script src="/assets/js/theme_manager.js" defer></script>
<script src="/assets/js/music_player.js"></script>
<script src="/assets/js/scroll.js"></script>
    </body>
</html>