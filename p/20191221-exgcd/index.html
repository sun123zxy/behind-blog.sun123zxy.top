<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>扩展欧几里得算法（ExGCD） - sun123zxy's Blog</title>

        <script src="/assets/thirds/jquery/jquery-3.5.1.min.js"></script>

        <link rel="stylesheet" href="/assets/thirds/katex/katex.min.css">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="/assets/thirds/katex/katex.min.js"></script>
        <!-- To automatically render math in text elements, include the auto-render extension -->
        <script defer src="/assets/thirds/katex/auto-render.min.js" onload="renderMathInElement(document.body)"></script>
        
        <script src="/assets/thirds/highlight/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
    </head>
    <body>
        <div id="home">
    <div id="main" class="panel panel-content">
        <div class="post-body">
    <div class="post-head">
        <h1 id="post-title">扩展欧几里得算法（ExGCD）</h1>
        <p class="abstract text-vice">
            
                No abstract provided here.
            
        </p>
    </div>
    <div class="post-content"><h2 id="瞎扯">瞎扯</h2>
<p>ExGCD用于求解不定方程</p>
<p><span class="math display">\[
ax + by = c
\]</span></p>
<p>的一组特解。常用于求解同余方程，比如求模非质数意义下的逆元。</p>
<h2 id="推导">推导</h2>
<h3 id="主体">主体</h3>
<p>首先，不定方程有解的充分必要条件由裴蜀定理给出</p>
<p><span class="math display">\[
\gcd(a,b) | c
\]</span></p>
<p>于是，我们只需关注</p>
<p><span class="math display">\[
ax + by = \gcd(a,b)
\]</span></p>
<p>的解。（原方程的解只需分别对<span
class="math inline">\(x\)</span>，<span
class="math inline">\(y\)</span>乘上<span
class="math inline">\(\frac{c}{gcd(a,b)}\)</span>即可求出）</p>
<p>（下文中%代指取模操作）</p>
<p>考虑递归的求解。假设我们已经知道了不定方程</p>
<p><span class="math display">\[
b x + (a \% b) y = \gcd(b, a\% b)
\]</span></p>
<p>的解<span class="math inline">\(x_1\)</span>，<span
class="math inline">\(y_1\)</span>，即</p>
<p><span class="math display">\[
b x_1 + (a \% b) y_1 = \gcd(b, a\% b)
\]</span></p>
<p>现在尝试利用此式构造出原方程的解<span
class="math inline">\(x\)</span>，<span
class="math inline">\(y\)</span>。</p>
<p>由 <span class="math inline">\(\gcd(a,b) = \gcd(b,a\%b)\)</span> 以及
<span class="math inline">\(a \% b = a- \lfloor \frac{a}{b} \rfloor
b\)</span></p>
<p>原式化为</p>
<p><span class="math display">\[
b x_1 + (a- \lfloor \frac{a}{b} \rfloor b) y_1 = \gcd(a,b)
\]</span></p>
<p>拆开括号</p>
<p><span class="math display">\[
b x_1 + a y_1 - \lfloor \frac a b \rfloor b y_1 = \gcd(a,b)
\]</span></p>
<p>我们的目标是构造出系数为<span class="math inline">\(a\)</span>，<span
class="math inline">\(b\)</span>的原方程，故整理得</p>
<p><span class="math display">\[
a y_1 + b(x_1 - \lfloor \frac a b \rfloor y_1) = \gcd(a,b)
\]</span></p>
<p>成功构造。故</p>
<p><span class="math display">\[
\begin{aligned}
x &amp;= y_1 \\
y &amp;= x_1 - \lfloor \frac a b \rfloor y_1
\end{aligned}
\]</span></p>
<p>该递归的边界条件同欧几里得算法，当<span
class="math inline">\(b=0\)</span>时，方程为</p>
<p><span class="math display">\[
a x = \gcd(a,0) = a
\]</span></p>
<p><span class="math inline">\(x=1\)</span>，<span
class="math inline">\(y = 0\)</span>即该方程的一组特解。</p>
<h3 id="构造最小x的特解">构造最小<span
class="math inline">\(x\)</span>的特解</h3>
<p>Exgcd常用于逆元求解。这时需要找到一组解，使得<span
class="math inline">\(x\)</span>最小（正整数范围内）。可以这样构造。</p>
<p>我们知道，不定方程的通解形式为</p>
<p><span class="math display">\[
\left\{
\begin{aligned}
x &amp;= x_0 + kt\\
y &amp;= y_0 - ku
\end{aligned}
\right.
\]</span></p>
<p>其中，<span class="math inline">\(t=\frac b {\gcd(a,b)}, u=\frac a
{\gcd(a,b)}\)</span></p>
<p>upd：友情提示一下大家通常了解到的通解形式里面的<span
class="math inline">\(t=b, u=a\)</span>，但是实际上该通解形式仅在<span
class="math inline">\(\gcd(a,b)=1\)</span>时正确（不过如果你没有意识到这一点也没啥问题，因为仍然能求出MOD内的逆元，，，）</p>
<p>所以，以<span class="math inline">\(x\)</span>为例，最小的正整数<span
class="math inline">\(x= (x_0 \% t +t) \%
t\)</span>，然后将其带入不定方程解出<span class="math inline">\(y=\frac
{c-a*x} {b}\)</span>即可。</p>
<h2 id="code">Code</h2>
<pre class="cpp"><code>namespace ExGcd{
    ll x,y;
    ll ExGcd(ll a,ll b){
        ll ans;
        if(b==0){
            x=1;y=0;ans=a;
        }else{
            ans=ExGcd(b,a%b);
            ll x1=x,y1=y;
            x=y1;y=x1-a/b*y1;
        }
        return ans;
    }
    bool SolveEqu(ll a,ll b,ll c){
        ll d=ExGcd(a,b);
        if(c%d!=0) return 0;
        x*=c/d;y*=c/d;
        //Minimize x
        ll t=b/d;
        x=(x%t+t)%t;
        y=(c-a*x)/b;
        return 1;
    }
}
//以下为求逆元
ll Inv(ll a,ll m){
    ExGcd::SolveEqu(a,m,1);
    return ExGcd::x;
}</code></pre>
<p>板题：<a href="https://www.luogu.org/problemnew/show/P1082">洛谷P1082
同余方程</a>，随便改改上面的程序即可。</p>
</div>
    <div class="post-tags text-vice" style="text-align: right">
        <p>tags: 
            
                <a href= "/tags#OI" >OI</a>, 
            
                <a href= "/tags#数学" >数学</a>, 
            
                <a href= "/tags#学习笔记" >学习笔记</a>
            
        </p>
        <p>posted on 2019/12/21 | last modified on 2019/12/21</p>
    </div>
    
        <div class="post-comments">
            <script src="https://giscus.app/client.js"
                data-repo="sun123zxy/sun123zxy.github.io"
                data-repo-id="MDEwOlJlcG9zaXRvcnkzMTAwMzQxNDc="
                data-category="General"
                data-category-id="DIC_kwDOEnq-484CQKFr"
                data-mapping="pathname"
                data-reactions-enabled="1"
                data-emit-metadata="0"
                data-input-position="bottom"
                data-theme="light"
                data-lang="en"
                crossorigin="anonymous">
            </script>
        </div>
    
</div>
    </div>
    <div id="sidebar">
        
            <div id="sidebar-profile" class="panel">
                
                <div class="panel-content">
                    <a href="/"><img class="avatar" src="/assets/images/pig.png"></img></a>
<p class="nickname">sun123zxy</p>
<div class="nav">
    <a href="/">Home</a> | 
    <a href="/p/aboutme">About</a> | 
    <a href="/tags">Tags</a>
</div>
<div class="feed">
    <img src="/assets/images/feed.png"></img>
    <a href="/feed.xml">Atom Feed</a>
</div>
<p>Next Phantasm...</p>
                </div>
            </div>
        
            <div id="sidebar-news" class="panel">
                
                <h2 class="panel-title">News</h2>
                
                <div class="panel-content">
                    <a href="https://info.flagcounter.com/1Zpv"><img src="https://s05.flagcounter.com/count2/1Zpv/bg_DDDDDD/txt_000000/border_CCCCCC/columns_2/maxflags_10/viewers_3/labels_0/pageviews_1/flags_0/percent_0/" alt="Flag Counter" border="0"></a>

<p>博客已迁移。访问 <a href="https://blog.sun123zxy.top">blog.sun123zxy.top</a> 获取更多信息。</p>
                </div>
            </div>
        
            <div id="sidebar-links" class="panel">
                
                <h2 class="panel-title">Links</h2>
                
                <div class="panel-content">
                    
<h3>My Friends</h3>
<ul>
    <li><a href="https://www.cnblogs.com/Railgunforever">吸取教训</a></li>
    <li><a href="https://p9t6g.github.io">p9t6g</a></li>
    <li><a href="https://tbyangz.github.io">TbYangZ</a></li>
    <li><a href="https://www.cnblogs.com/ALANALLEN21LOVE28">CJ SYH</a></li>
</ul>

<h3>Related Sites</h3>
<ul>
    <li><a href="http://www.cnblogs.com/sun123zxy">博客园</a></li>
    <li><a href="http://tools.sun123zxy.top">工具站</a></li>
</ul>
                </div>
            </div>
        
            <div id="sidebar-tags" class="panel">
                
                <h2 class="panel-title">Tags</h2>
                
                <div class="panel-content">
                    <ul>
    
    <li><a href= "/tags#OI" >OI</a></li>
    
    <li><a href= "/tags#数学" >数学</a></li>
    
    <li><a href= "/tags#高考" >高考</a></li>
    
    <li><a href= "/tags#题解" >题解</a></li>
    
    <li><a href= "/tags#原创题目" >原创题目</a></li>
    
    <li><a href= "/tags#学习笔记" >学习笔记</a></li>
    
    <li><a href= "/tags#意识流" >意识流</a></li>
    
    <li><a href= "/tags#游记" >游记</a></li>
    
    <li><a href= "/tags#Web" >Web</a></li>
    
    <li><a href= "/tags#站点相关" >站点相关</a></li>
    
    <li><a href= "/tags#Python" >Python</a></li>
    
</ul>
                </div>
            </div>
        
        
            <div id="contents" class="panel"><h2 class="panel-title">Contents</h2>
<div class="panel-content"></div>
<script defer src="/assets/js/contents.js"></script></div>
        
    </div>
    <div class="fclean"></div>
    <div id="footer" class="text-vice">
        <p>sun123zxy's Blog | Powered by Jekyll</p>
    </div>
</div>
<div id="leftdown-float-container">
    <div id="theme-info" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/info.png"></img></div>
        <div class="hover-info">Theme Info</div>
    </div>
    <div id="theme-switch" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/switch.png"></img></div>
        <div class="hover-info">Theme Switch</div>
    </div>
</div>
<div id="rightdown-float-container">
    <div id="music-player" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/music.png"></img></div>
        <div class="hover-info">Music Player</div>
    </div>
</div>
<link rel="stylesheet" href="/assets/css/default.css">
<link rel="stylesheet" id="night-container">
<link rel="stylesheet" id="theme-container">
<div id="mask"></div>
<script src="/assets/js/theme_data.js"></script>
<script src="/assets/js/round_button.js"></script>
<script src="/assets/js/theme_manager.js" defer></script>
<script src="/assets/js/music_player.js"></script>
<script src="/assets/js/scroll.js"></script>
    </body>
</html>