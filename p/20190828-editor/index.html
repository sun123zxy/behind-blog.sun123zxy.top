<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>[NOIP模拟]文本编辑器 题解 - sun123zxy's Blog</title>

        <script src="/assets/thirds/jquery/jquery-3.5.1.min.js"></script>

        <link rel="stylesheet" href="/assets/thirds/katex/katex.min.css">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="/assets/thirds/katex/katex.min.js"></script>
        <!-- To automatically render math in text elements, include the auto-render extension -->
        <script defer src="/assets/thirds/katex/auto-render.min.js" onload="renderMathInElement(document.body)"></script>
        
        <script src="/assets/thirds/highlight/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
    </head>
    <body>
        <div id="home">
    <div id="main" class="panel panel-content">
        <div class="post-body">
    <div class="post-head">
        <h1 id="post-title">[NOIP模拟]文本编辑器 题解</h1>
        <p class="abstract text-vice">
            
                No abstract provided here.
            
        </p>
    </div>
    <div class="post-content"><p><a
href="https://oj.bashu.com.cn/code/problempage.php?problem_id=5089">bsoj5089
文本编辑器</a></p>
<pre><code>题意描述

九发明了一个完美的文本编辑器。这个编辑器拥有两个光标（cursor），所以九能够同时在两处地方插入和删除文本。这个编辑器除了正常的编辑功能以外，还有一些只有九才知道用处的功能，例如翻转两个光标之间的文本。某一天，九把自己的完美文本编辑器给弄丢了，但是她还有好多好多文本需要处理。于是她想请聪明又智慧的你帮她实现完美文本编辑器的一些功能。 
功能列表如下：

功能名称        命令格式    说明
&lt; (move left)   &lt; w w   为一个字符，“L”或“R”，表示左光标还是右光标（下同）。该命令将选定光标向左移动，如果已经是最左端则不移动。命令执行成功时输出“T”，若光标已经在最左端，则输出“F”。
&gt; (move right)  &gt; w w   同上。与&lt; 命令不同的是，该命令将光标向右移动。命令执行成功时输出“T”，若光标已经在最右端，则输出“F”。
I (insert)      I w c   同上。c 是一个可见字符(33≤ ascii 码 ≤ 126)，代表在该光标左侧插入该字符。该命令始终输出“T”。
D (delete)      D w w   同上。代表删除该光标右侧的一个字符。命令执行成功时输出“T”，若光标右侧没有字符输出“F”。
R (reverse) R           代表翻转左光标和右光标之间的字符。该命令只有左光标在右光标左侧时才能执行。（两光标重合时也不能执行）命令执行成功时输出“T”，否则输“F”。
S (show)    S           代表显示当前处理的文本。该命令只输出文本，不输出“T”和“F”。
开始时文本编辑器中有一定内容，左光标在第一个字符左，右光标在最后一个字符右。

注意：在插入和删除操作中，没有被操作的光标与文本的相对左右位置保持不变。特别地，若两个光标重叠，操作后也仍然重叠。

输入格式

第一行是初始时文本编辑器内容。

第二行是一个正整数 N，N 表示操作次数。

接下来有 N 行，每行有一个命令，命令格式如上方表格。

输出格式

对于每个命令，按上方表格要求执行并输出。

样例输入

goodykc 
11 
I R u 
I R l 
&gt; L 
&gt; L 
&gt; L 
&gt; L 
R 
D R 
&lt; R 
D R 
S

样例输出

T 
T 
T 
T 
T 
T 
T 
F 
T 
T 
goodluck

样例解释

[goodykc] 
[goodykcu] 
[goodykcul] 
g[oodykcul] 
go[odykcul] 
goo[dykcul] 
good[ykcul] 
good[lucky] 
good[lucky]（光标右边没有字符，失败删除） 
good[luck]y 
good[luck] 
goodluck

数据规模与约定

对于 40% 的数据：1 ≤ N , 初始文本长度 ≤ 100，数据不包含翻转（Reverse）操作；
另有 30% 的数据：1 ≤ N , 初始文本长度 ≤ 105，数据不包含翻转（Reverse）操作；
另有 20% 的数据：1 ≤ N , 初始文本长度 ≤ 105，数据包含翻转（Reverse）操作；
对于 100% 的数据：1 ≤ N , 初始文本长度 ≤ 4 × 106，输出文件大小 ≤ 20MB;</code></pre>
<p>没找到这道题的出处</p>
<p>我不知道为啥有人用splay还有什么双端队列做这道题</p>
<p>反正我考场一看这题就兴奋了</p>
<p>这不直接双向链表暴搞吗</p>
<p>Reverse就直接这样接一下就没了</p>
<figure>
<img src="rev.png" alt="rev" />
<figcaption aria-hidden="true">rev</figcaption>
</figure>
<p>不过这样将让双向链表无法判断左右方向，那就直接将双向链表变成无向的，指针记录真实的在左边的那个节点的编号，这样就像遍历树那样可以判方向了</p>
<p>考场3kb 70pt，考后+2kb 加上了rev操作</p>
<p>代码权当纪念，诸位看看笑笑就好</p>
<p>反正我是已经看不懂了:p</p>
<p>各种结构体引用三目运算符函数混乱毫无可读性的5kb代码</p>
<pre class="cpp"><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cmath&gt;
#include&lt;cstring&gt;
#include&lt;ctime&gt;
#include&lt;cstdlib&gt;
#include&lt;algorithm&gt;
#include&lt;queue&gt;
#include&lt;vector&gt;
#include&lt;map&gt;
using namespace std;
const int INF=999999999;

const int MXN=8E6+5;

struct Node{
    int v1,v2;
    char c;
}nd[MXN];int pN;
struct Pter{
    int id,pre;
    /*void Debug(){
        cout&lt;&lt;&quot;Pter:&quot;&lt;&lt;id&lt;&lt;&quot;#&quot;&lt;&lt;pre&lt;&lt;endl;
    }*/
}p1,p2;
Pter Copy(Pter&amp; A){
    Pter B=(Pter){A.id,A.pre};
    return B;
}
bool IsOK(Pter p){
    if(p.id==0||(p.id==INF&amp;&amp;p.pre==INF)) return 0;
    return 1;
}

char str[MXN];int rpL,rpR;
void Build(){
    int sLen=strlen(str);pN=sLen;
    for(int i=1;i&lt;sLen;i++) nd[i].v2=i+1;
    for(int i=2;i&lt;=sLen;i++) nd[i].v1=i-1;
    nd[1].v1=0;nd[sLen].v2=INF;
    for(int i=1;i&lt;=sLen;i++) nd[i].c=str[i-1];
    nd[0].v1=-INF,nd[0].v2=1;
    p1.id=1;p1.pre=0;
    p2.id=INF;p2.pre=sLen;
    
    rpL=1;rpR=strlen(str)+1;
}
Pter Left(Pter&amp; nw){
    int le=nw.pre;
    if(le==0) return (Pter){0,0};
    int lele=(nd[le].v1!=nw.id)?nd[le].v1:nd[le].v2;
    Pter p=(Pter){le,lele};
    return p;
}
Pter Right(Pter&amp; nw){
    int id=nw.id;if(id==INF) return (Pter){INF,INF};
    int ri=(nd[id].v1==nw.pre)?nd[id].v2:nd[id].v1;
    Pter p=(Pter){ri,id};
    return p;
}
void Ins(Pter&amp; nw,char c){
    pN++;nd[pN].c=c;
    int id=nw.id;
    Pter le=Left(nw);
    nd[pN].v1=le.id;nd[pN].v2=nw.id;
    
    int&amp; leR=(nd[le.id].v1==id?nd[le.id].v1:nd[le.id].v2);
    leR=pN;
    
    if(IsOK(Right(nw))){
        int&amp; nwL=(nd[id].v1==nw.pre?nd[id].v1:nd[id].v2);
        nwL=pN;
    }
    nw.pre=pN;
}
bool Del(Pter&amp; nw){
    if(nw.id==INF){printf(&quot;F&quot;);return 0;}
    Pter le=Left(nw);
    Pter ri=Right(nw);
    
    int&amp; leR=(nd[le.id].v1==nw.id?nd[le.id].v1:nd[le.id].v2);
    leR=ri.id;
    
    if(IsOK(Right(ri))){
        int&amp; riL=(nd[ri.id].v1==nw.id?nd[ri.id].v1:nd[ri.id].v2);
        riL=le.id;
    }
    nw.id=ri.id;
    nw.pre=le.id;
    printf(&quot;T&quot;);
    return 1;
}
void Rev(){
    Pter L=Copy(p1);
    Pter LL=Left(L);
    Pter RR=Copy(p2);
    Pter R=Left(RR);
    //cout&lt;&lt;L.id&lt;&lt;&quot;,&quot;&lt;&lt;LL.id&lt;&lt;&quot;#&quot;&lt;&lt;R.id&lt;&lt;&quot;,&quot;&lt;&lt;RR.id&lt;&lt;&quot;###&quot;;
    int&amp; leleR=(nd[LL.id].v1==L.id?nd[LL.id].v1:nd[LL.id].v2);
    leleR=R.id;
    
    int&amp; leL  =(nd[L.id].v1==LL.id?nd[L.id].v1:nd[L.id].v2);
    leL=RR.id;
    
    if(IsOK(Right(RR))){
        int&amp; ririL=(nd[RR.id].v1==R.id?nd[RR.id].v1:nd[RR.id].v2);
        ririL=L.id;
    }
    int&amp; riR  =(nd[R.id].v1==RR.id?nd[R.id].v1:nd[R.id].v2);
    riR=LL.id;
    
    
    p1.id=R.id;
    p2.pre=L.id;
}
void Print(){
    Pter p=(Pter){nd[0].v2,0};
    while(IsOK(Right(p))){//p.Debug();
        printf(&quot;%c&quot;,nd[p.id].c);
        p=Right(p);
        
    }
}

int main(){
    scanf(&quot;%s&quot;,str);
    Build();
    int qN;cin&gt;&gt;qN;
    for(int i=1;i&lt;=qN;i++){
        char typ[2];scanf(&quot;%s&quot;,typ);
        char wch[2],ccc[2];
        switch(typ[0]){
             case &#39;&lt;&#39;:{//cout&lt;&lt;&quot;#&quot;;
                scanf(&quot;%s&quot;,wch);Pter&amp; p=(wch[0]==&#39;L&#39;)?p1:p2;
                Pter lp=Left(p);
                if(!IsOK(lp)) printf(&quot;F&quot;);
                else{
                    printf(&quot;T&quot;);
                    p=lp;
                    ((wch[0]==&#39;L&#39;)?rpL:rpR) --;
                }
                //p.Debug();
                break;
            }case &#39;&gt;&#39;:{//cout&lt;&lt;&quot;V&quot;;
                scanf(&quot;%s&quot;,wch);Pter&amp; p=(wch[0]==&#39;L&#39;)?p1:p2;
                Pter rp=Right(p);
                if(!IsOK(rp)) printf(&quot;F&quot;);
                else{
                    printf(&quot;T&quot;);
                    p=rp;
                    ((wch[0]==&#39;L&#39;)?rpL:rpR) ++;
                }
                //p.Debug();
                break;
            }case &#39;I&#39;:{
                scanf(&quot;%s&quot;,wch);Pter&amp; p=(wch[0]==&#39;L&#39;)?p1:p2;
                Pter&amp; otr=(wch[0]==&#39;L&#39;)?p2:p1;
                int&amp; ooo=(wch[0]==&#39;L&#39;)?rpL:rpR;
                int&amp; ppp=(wch[0]==&#39;L&#39;)?rpR:rpL;
                scanf(&quot;%s&quot;,ccc);char c=ccc[0];
                int bomb=0;
                if(p.id==otr.id&amp;&amp;p.pre==otr.pre) bomb=1;
                Ins(p,c);
                printf(&quot;T&quot;);
                if(bomb==1) otr.id=p.id,otr.pre=p.pre;
                if(ooo&lt;=ppp) ppp++;
                ooo++;
                break;
            }case &#39;D&#39;:{
                scanf(&quot;%s&quot;,wch);Pter&amp; p=(wch[0]==&#39;L&#39;)?p1:p2;
                Pter&amp; otr=(wch[0]==&#39;L&#39;)?p2:p1;
                int&amp; ooo=(wch[0]==&#39;L&#39;)?rpL:rpR;
                int&amp; ppp=(wch[0]==&#39;L&#39;)?rpR:rpL;
                int bomb=0;
                if(p.id==otr.id&amp;&amp;p.pre==otr.pre) bomb=1;
                else if(otr.pre==p.id) bomb=2;
                bool isSuc=Del(p);
                if(bomb==1) otr.id=p.id,otr.pre=p.pre;
                else if(bomb==2) otr.pre=p.pre;
                //p.Debug();otr.Debug();
                if(isSuc){
                    if(ooo&lt;ppp) ppp--;
                }
                break;
            }case &#39;R&#39;:{
                //printf(&quot;F&quot;);
                if(rpL&lt;rpR){
                    Rev();
                    printf(&quot;T&quot;);
                }else{
                    printf(&quot;F&quot;);
                } 
                break;
            }case &#39;S&#39;:{
                Print();
                break;
            }
        }
        //cout&lt;&lt;p1.id&lt;&lt;&#39;,&#39;&lt;&lt;p1.pre&lt;&lt;&quot;|&quot;&lt;&lt;p2.id&lt;&lt;&quot;,&quot;&lt;&lt;p2.pre&lt;&lt;endl;
        //cout&lt;&lt;&quot;!&quot;&lt;&lt;rpL&lt;&lt;&#39;,&#39;&lt;&lt;rpR;
        printf(&quot;\n&quot;);
    }
    return 0;
}
/*
ab
111
R
S

goodykc
11
I R u
I R l
&gt; L
&gt; L
&gt; L
&gt; L
R
D R
&lt; R
D R
S
*/</code></pre>
</div>
    <div class="post-tags text-vice" style="text-align: right">
        <p>tags: 
            
                <a href= "/tags#OI" >OI</a>, 
            
                <a href= "/tags#题解" >题解</a>
            
        </p>
        <p>posted on 2019/08/28 | last modified on 2019/08/28</p>
    </div>
    
        <div class="post-comments">
            <script src="https://giscus.app/client.js"
                data-repo="sun123zxy/sun123zxy.github.io"
                data-repo-id="MDEwOlJlcG9zaXRvcnkzMTAwMzQxNDc="
                data-category="General"
                data-category-id="DIC_kwDOEnq-484CQKFr"
                data-mapping="pathname"
                data-reactions-enabled="1"
                data-emit-metadata="0"
                data-input-position="bottom"
                data-theme="light"
                data-lang="en"
                crossorigin="anonymous">
            </script>
        </div>
    
</div>
    </div>
    <div id="sidebar">
        
            <div id="sidebar-profile" class="panel">
                
                <div class="panel-content">
                    <a href="/"><img class="avatar" src="/assets/images/pig.png"></img></a>
<p class="nickname">sun123zxy</p>
<div class="nav">
    <a href="/">Home</a> | 
    <a href="/p/aboutme">About</a> | 
    <a href="/tags">Tags</a>
</div>
<div class="feed">
    <img src="/assets/images/feed.png"></img>
    <a href="/feed.xml">Atom Feed</a>
</div>
<p>Next Phantasm...</p>
                </div>
            </div>
        
            <div id="sidebar-news" class="panel">
                
                <h2 class="panel-title">News</h2>
                
                <div class="panel-content">
                    <a href="https://info.flagcounter.com/1Zpv"><img src="https://s05.flagcounter.com/count2/1Zpv/bg_DDDDDD/txt_000000/border_CCCCCC/columns_2/maxflags_10/viewers_3/labels_0/pageviews_1/flags_0/percent_0/" alt="Flag Counter" border="0"></a>

<p>博客已迁移。访问 <a href="https://blog.sun123zxy.top">blog.sun123zxy.top</a> 获取更多信息。</p>
                </div>
            </div>
        
            <div id="sidebar-links" class="panel">
                
                <h2 class="panel-title">Links</h2>
                
                <div class="panel-content">
                    
<h3>My Friends</h3>
<ul>
    <li><a href="https://www.cnblogs.com/Railgunforever">吸取教训</a></li>
    <li><a href="https://p9t6g.github.io">p9t6g</a></li>
    <li><a href="https://tbyangz.github.io">TbYangZ</a></li>
    <li><a href="https://www.cnblogs.com/ALANALLEN21LOVE28">CJ SYH</a></li>
</ul>

<h3>Related Sites</h3>
<ul>
    <li><a href="http://www.cnblogs.com/sun123zxy">博客园</a></li>
    <li><a href="http://tools.sun123zxy.top">工具站</a></li>
</ul>
                </div>
            </div>
        
            <div id="sidebar-tags" class="panel">
                
                <h2 class="panel-title">Tags</h2>
                
                <div class="panel-content">
                    <ul>
    
    <li><a href= "/tags#OI" >OI</a></li>
    
    <li><a href= "/tags#数学" >数学</a></li>
    
    <li><a href= "/tags#高考" >高考</a></li>
    
    <li><a href= "/tags#题解" >题解</a></li>
    
    <li><a href= "/tags#原创题目" >原创题目</a></li>
    
    <li><a href= "/tags#学习笔记" >学习笔记</a></li>
    
    <li><a href= "/tags#意识流" >意识流</a></li>
    
    <li><a href= "/tags#游记" >游记</a></li>
    
    <li><a href= "/tags#Web" >Web</a></li>
    
    <li><a href= "/tags#站点相关" >站点相关</a></li>
    
    <li><a href= "/tags#Python" >Python</a></li>
    
</ul>
                </div>
            </div>
        
        
            <div id="contents" class="panel"><h2 class="panel-title">Contents</h2>
<div class="panel-content"></div>
<script defer src="/assets/js/contents.js"></script></div>
        
    </div>
    <div class="fclean"></div>
    <div id="footer" class="text-vice">
        <p>sun123zxy's Blog | Powered by Jekyll</p>
    </div>
</div>
<div id="leftdown-float-container">
    <div id="theme-info" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/info.png"></img></div>
        <div class="hover-info">Theme Info</div>
    </div>
    <div id="theme-switch" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/switch.png"></img></div>
        <div class="hover-info">Theme Switch</div>
    </div>
</div>
<div id="rightdown-float-container">
    <div id="music-player" class="round-button-handler">
        <div class="round-button"><img src="/assets/images/music.png"></img></div>
        <div class="hover-info">Music Player</div>
    </div>
</div>
<link rel="stylesheet" href="/assets/css/default.css">
<link rel="stylesheet" id="night-container">
<link rel="stylesheet" id="theme-container">
<div id="mask"></div>
<script src="/assets/js/theme_data.js"></script>
<script src="/assets/js/round_button.js"></script>
<script src="/assets/js/theme_manager.js" defer></script>
<script src="/assets/js/music_player.js"></script>
<script src="/assets/js/scroll.js"></script>
    </body>
</html>